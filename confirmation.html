<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="confirmationstyles.css">

    <title>Spicer Car Detailing</title>
</head>
<body>
    <div class="logo">
        <img src="SPICER_DETAILING_LOGO (6).jpg">
    </div>
    <hr class="logosep">
    <div class="pagetitle" id="pagetitle"></div>
    <div class="bookinginstructions">
        Enter your info below to contant us, and we will reach out with our availability as soon as possible! We take payment in cash or E-Transfer when you pick up your detailed vehicle!
    </div>
    <form id="contact-form">
        <div class="inputcontainer">
            <input class="input" id="user_email" autocomplete="off" placeholder="you@example.com">
            <input class="input" id="user_name" autocomplete="off" placeholder="First name">
            <button class="enterbutton" onclick="enterInfo()">Enter</button>
        </div>
    <div class="feedback" id="feedback">

    </div>
    </form>
    
    <script type="module">
    import emailjs from 'https://cdn.jsdelivr.net/npm/@emailjs/browser@3.11.0/+esm';

  emailjs.init('-DYfRv7o-Frgm4EGW');



var email;
var name;
document.getElementById("user_email").addEventListener("keydown", function(event) {
  if (event.key === "Enter") {
    email = event.target.value;
    name = document.getElementById("user_name").value;
    verifyInfo(email, name);
  }
});

function enterInfo() {
    email = document.getElementById("user_email").value;
    name = document.getElementById("user_name").value;
    alert("recieved info!");
    verifyInfo(email, name);
}

function verifyInfo(email, name) {
    if (email.includes("@") && email.includes(".") && (name)) {
        document.getElementById("feedback").innerText = "Please wait: sending email...";
        document.getElementById("feedback").style.color = "orange";

        const templateParams = {
            user_name: name,
            user_email: email
        };
        alert("verification success");
        sendEmail(templateParams);
    }
    else {
        document.getElementById("feedback").innerText = "Invalid email: please retry.";
        document.getElementById("feedback").style.color = "red";
        alert("verification failed");
    }
}

function sendEmail(templateParams) {
  // Email to yourself
  emailjs.send("service_ik0q0xg", "template_3uxpuza", {
    user_name: templateParams.user_name,
    user_email: "spicercardetailing@gmail.com", // YOUR email hardcoded
  })
  .then(() => console.log("Internal email sent"))
  .catch((error) => console.error("Internal email failed:", error));

  // Email to the customer
  emailjs.send("service_ik0q0xg", "template_8v8bf4r", templateParams)
  .then(() => alert("Confirmation sent to customer!"))
  .catch((error) => alert("Failed to send confirmation."));
}</script>
</body>
</html>